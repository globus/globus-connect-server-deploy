# syntax=docker/dockerfile:1.3-labs

############### STAGE 1 - Prepare the image for GCS installation ###############
FROM opensuse/leap:15.5

# Prereqs
RUN <<EOF
    # Ansible 2.12 will require python38 or newer
    zypper install -y coreutils gzip python311 sudo tar util-linux
    # This helps stage 2 (ansible install) find python
    ln -s /usr/bin/python3.11 /usr/bin/python3
EOF

##################### STAGE 2 - Install GCS using Ansible ######################
# This is the base64 compressed tar of the ansible repo directory
COPY <<EOF /ansible.64
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
SJEiRYoUKXoH0v8D2iU3sQDIAAA=
EOF

RUN <<EOF
    set -e
    /usr/bin/python3 -m venv /venv
    /venv/bin/pip install --upgrade pip
    # Install wheel to avoid the warning that setup.py is being used when
    # installing Ansible
    /venv/bin/pip install wheel
    /venv/bin/pip install ansible
    cat /ansible.64 | base64 -d | (cd /; tar zxf -)
EOF

ARG GLOBUS_ANSIBLE_OPTIONS

# Modifying this arg value on the build command line will cause RUN to reinstall
# Globus instead of using the previous, cached iteration (if it exists). Useful
# for speeding up re-runs to get newer Globus versions.
ARG CACHEBUST=1

RUN <<EOF
    (cd /ansible; /venv/bin/ansible-playbook playbook.yml ${GLOBUS_ANSIBLE_OPTIONS})
EOF

######################### STAGE 3 - Prepare GCS Image ##########################
LABEL maintainer="support@globus.org"

# This is the base64 compressed tar of entrypoint.sh
COPY <<EOF /entrypoint.64
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
eBgP42E8jC8b/wGXDHEMACgAAA==
EOF

RUN <<EOF
    cat /entrypoint.64 | base64 -d | tar zxf - > /entrypoint.sh
EOF

# These are the default ports in use by GCSv5.4. Currently, they can not be changed.
#   443 : HTTPD service for GCS Manager API and HTTPS access to collections
#  50000-51000 : Default port range for incoming data transfer tasks
EXPOSE 443/tcp 50000-51000/tcp

# Default command unless overriden with 'docker run --entrypoint'
ENTRYPOINT ["/entrypoint.sh"]
# Default options to ENTRYPOINT unless overriden with 'docker run arg1...'
CMD []
